# Task # 3
## Requirements
Задание 3

(Обязательно к выполнению)

Написать следующие запросы к БД:

1. Посчитать количество постов для пользователя с заданным ID;

2. Выбрать N опубликованных постов, отсортированных в порядке убывания даты создания;
3. Выбрать N постов в статусе "ожидает публикации", отсортированных в порядке возрастания даты создания;
4. Найти N недавно обновленных постов определенного тэга для K страницы (в каждой странице L постов).
5. Найти N постов с наибольшим рейтингом за день/месяц/год.

6. Оценить время выполнения запросов (на достаточном количестве тестовых данных) и проанализировать план выполнения запросов.
7. Сократить время на выполнение запросов, используя подходящие индексы. Сравнить время выполнения и план запросов после создания индексов.
8. Оценить размер используемых индексов. При возможности - сократить размер созданных индексов.

## Solution

`1.` Посчитать количество постов для пользователя с заданным ID;

```sql
--8<-- "src/task3/queries/query3_1.sql"
```

```py
--8<-- "src/task3/test_3_1.py"
```

`2.` Выбрать N опубликованных постов, отсортированных в порядке убывания даты создания;

```sql
--8<-- "src/task3/queries/query3_2.sql"
```

```py
--8<-- "src/task3/test_3_2.py"
```

`3.` Выбрать N постов в статусе "ожидает публикации", отсортированных в порядке возрастания даты создания;

```sql
--8<-- "src/task3/queries/query3_3.sql"
```

```py
--8<-- "src/task3/test_3_3.py"
```

`4.` Найти N недавно обновленных постов определенного тэга для K страницы (в каждой странице L постов).

```sql
--8<-- "src/task3/queries/query3_4.sql"
```

```py
--8<-- "src/task3/test_3_4.py"
```

`5.` Найти N постов с наибольшим рейтингом за день/месяц/год.

```sql
--8<-- "src/task3/queries/query3_5.sql"
```

```py
--8<-- "src/task3/test_3_5.py"
```

`6.` Оценить время выполнения запросов (на достаточном количестве тестовых данных) и проанализировать план выполнения запросов.

Выполним вместе с 7м пунктом

`7.` Сократить время на выполнение запросов, используя подходящие индексы. Сравнить время выполнения и план запросов после создания индексов.

```py
--8<-- "src/task3/test_3_6.py"
```

`8.` Оценить размер используемых индексов. При возможности - сократить размер созданных индексов.